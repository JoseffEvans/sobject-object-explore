<html>
    <body>
        <h1>{{obj.name}}</h1>
        <div><a href="command:sobject-object-explore-open?%7B%22env%22:%20%22{{env}}%22,%20%22sobject%22:%20%22{{obj.name}}%22,%20%22refresh%22:%20true%7D">Refresh</a></div>
        <input type="text" id="fieldSearch"/>
        <div 
            id="fields"
            style="display: flex; flex-direction: column;"
        >
            {% for i, field in obj.fields.entries() %}
                <a 
                    index="{{i}}"
                    sobjectName="{{field.name}}"
                    sobjectLabel="{{field.label}}"
                    style="display: block; text-decoration: none;"
                    href="command:sobject-object-explore-open?%7B%22env%22:%20%22{{env}}%22,%20%22sobject%22:%20%22{{obj.name}}%22,%20%22field%22:%20%22{{field.name}}%22%7D"
                >
                    <pre style="margin:0;">{{field.label.padEnd(paddingData.label, ' ')}} -- {{field.name.padEnd(paddingData.name, ' ')}} -- {{types[field.name]}}</pre>
                </a>
            {% endfor %}
        </div>

        <script>
            var fields = [...document.getElementById("fields").children];

            /** @param {string} str @param {string} term*/
            function incudeInParts(str, term){
                var parts = term.split(' ')
                var matches = parts.filter(term => str.toLowerCase().includes(term));
                return matches.length == parts.length;
            }
            
            document.getElementById("fieldSearch").addEventListener("input", (event) => {
                var searchTerm = event.target.value.toLowerCase();

                fields.forEach(field => {
                    var show = 
                        !searchTerm ||
                        incudeInParts(field.getAttribute("sobjectName"), searchTerm) ||
                        incudeInParts(field.getAttribute("sobjectLabel"), searchTerm);

                    field.style.display = show ? "block" : "none";
                });
            });
        </script>
    </body>
</html>